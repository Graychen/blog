<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>swoole利用websocket进行wss访问 | Graychen的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="最近利用swoole的websocket对扫码登录进行重构，原本是利用长轮循监听用户的的扫码，但对服务器的资源消耗太大，所以改用websocket节省带宽和服务器资源。  websocket: 一种在单个 TCP 连接上进行全双工通讯的协议。使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。在WebSocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直">
<meta name="keywords" content="技术">
<meta property="og:type" content="article">
<meta property="og:title" content="swoole利用websocket进行wss访问">
<meta property="og:url" content="http://graychen.git.io/2018/01/03/websocket结合swoole进行wss访问/index.html">
<meta property="og:site_name" content="Graychen的博客">
<meta property="og:description" content="最近利用swoole的websocket对扫码登录进行重构，原本是利用长轮循监听用户的的扫码，但对服务器的资源消耗太大，所以改用websocket节省带宽和服务器资源。  websocket: 一种在单个 TCP 连接上进行全双工通讯的协议。使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。在WebSocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直">
<meta property="og:updated_time" content="2018-01-03T15:20:10.123Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="swoole利用websocket进行wss访问">
<meta name="twitter:description" content="最近利用swoole的websocket对扫码登录进行重构，原本是利用长轮循监听用户的的扫码，但对服务器的资源消耗太大，所以改用websocket节省带宽和服务器资源。  websocket: 一种在单个 TCP 连接上进行全双工通讯的协议。使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。在WebSocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直">
  
    <link rel="alternative" href="/atom.xml" title="Graychen的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="//favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/assets/blogImg/avatar.jpg" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Graychen</a></h1>
		</hgroup>

		
		<p class="header-subtitle">这个世界需要更多的英雄</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/categories/随笔">随笔</a></li>
				        
							<li><a href="/categories/技术">技术文章</a></li>
				        
							<li><a href="/categories/错误日志">错误日志</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Graychen" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/u/5508881293/home?topnav=1&wvr=6" title="weibo">weibo</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/huashendung" title="twitter">twitter</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/devops/" style="font-size: 13.33px;">devops</a> <a href="/tags/linux/" style="font-size: 13.33px;">linux</a> <a href="/tags/linux基础/" style="font-size: 13.33px;">linux基础</a> <a href="/tags/php/" style="font-size: 20px;">php</a> <a href="/tags/php-php扩展-c/" style="font-size: 16.67px;">php php扩展 c</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a> <a href="/tags/技术/" style="font-size: 10px;">技术</a> <a href="/tags/技术-php/" style="font-size: 13.33px;">技术 php</a> <a href="/tags/编辑器/" style="font-size: 13.33px;">编辑器</a> <a href="/tags/错误日志/" style="font-size: 10px;">错误日志</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Graychen</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="/assets/blogImg/avatar.jpg" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Graychen</h1>
			</hgroup>
			
			<p class="header-subtitle">这个世界需要更多的英雄</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/categories/随笔">随笔</a></li>
		        
					<li><a href="/categories/技术">技术文章</a></li>
		        
					<li><a href="/categories/错误日志">错误日志</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Graychen" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/5508881293/home?topnav=1&wvr=6" title="weibo">weibo</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/huashendung" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-websocket结合swoole进行wss访问" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/01/03/websocket结合swoole进行wss访问/" class="article-date">
  	<time datetime="2018-01-03T13:32:26.000Z" itemprop="datePublished">2018-01-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      swoole利用websocket进行wss访问
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/技术/">技术</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近利用swoole的websocket对扫码登录进行重构，原本是利用长轮循监听用户的的扫码，但对服务器的资源消耗太大，所以改用websocket节省带宽和服务器资源。</p>
<blockquote>
<p><strong>websocket</strong>: 一种在单个 TCP 连接上进行全双工通讯的协议。使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。在WebSocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直接可以创建持久性的连接，并进行双向数据传输。</p>
</blockquote>
<h2 id="在docker中搭建swoole的环境"><a href="#在docker中搭建swoole的环境" class="headerlink" title="在docker中搭建swoole的环境"></a>在docker中搭建swoole的环境</h2><ul>
<li><p>先建立build_swoole.sh这样的安装shell文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">apk add git autoconf build-base linux-headers libaio-dev pcre-dev openssl-dev icu-dev</div><div class="line">ln -s /usr/bin/php-config7 /usr/bin/php-config</div><div class="line">ln -s /usr/bin/phpize7 /usr/bin/phpize</div><div class="line">cd /root/</div><div class="line">git clone https://github.com/swoole/swoole-src.git</div><div class="line">cd /root/swoole-src</div><div class="line">phpize</div><div class="line">./configure --enable-openssl</div><div class="line">make &amp;&amp; make install</div><div class="line">apk del libaio-dev php-dev git autoconf build-base linux-headers pcre-dev</div><div class="line">apk del --no-cache php-dev</div><div class="line">apk del --no-cache git</div><div class="line">apk del --no-cache build-base</div><div class="line">apk del --no-cache make</div><div class="line">apk del --no-cache openssl-dev</div><div class="line">apk del --no-cache linux-headers</div><div class="line">apk del --no-cache libaio-dev</div><div class="line">apk del --no-cache pcre-dev</div><div class="line">apk del --no-cache autoconf</div><div class="line">apk del --no-cache .persistent-deps</div><div class="line">apk del --no-cache libmcrypt-dev</div><div class="line">apk del --no-cache g++</div><div class="line"># apk del --no-cache icu-dev</div><div class="line">apk info</div><div class="line">php -m</div><div class="line">rm -rf /var/cache/apk/*</div><div class="line">rm -rf /root/swoole-src/</div><div class="line">rm -rf /tmp/*</div></pre></td></tr></table></figure>
</li>
<li><p>然后在Dockerfile中使用我们的安装脚本,编译安装成功后，修改php.ini加入<code>extension=swoole.so</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">FROM zacksleo/php:7.1-alpine-fpm-supervisor</div><div class="line">COPY build_swoole.sh /root</div><div class="line">RUN sh /root/build_swoole.sh</div></pre></td></tr></table></figure>
</li>
<li><p>接着<code>docker-composer build 创建对应的docker镜像</code>，并且运行<code>docker-composer up</code>，在进入对应的docker容器中<code>docker exec 你的镜像名</code>,执行命令<code>php -m</code>,如果出现swoole，那我们的swoole扩展就安装好了</p>
<a id="more"></a>
<h2 id="创建服务器的swoole的监听"><a href="#创建服务器的swoole的监听" class="headerlink" title="创建服务器的swoole的监听"></a>创建服务器的swoole的监听</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">console</span>\<span class="title">controllers</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">common</span>\<span class="title">models</span>\<span class="title">QrcodeToken</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">yii</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">common</span>\<span class="title">models</span>\<span class="title">User</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">console</span>\<span class="title">Controller</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">Swoole</span>\<span class="title">WebSocket</span>\<span class="title">Server</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Class PremiumController</div><div class="line"> * <span class="doctag">@package</span> console\controllers</div><div class="line"> * <span class="doctag">@auth</span> graychen &lt;455803034<span class="doctag">@qq</span>.com&gt;</div><div class="line"> */</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebSocketController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> $server;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * websocket 监听扫码登录</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionListenLogin</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        $setConfig = <span class="keyword">array</span>(</div><div class="line">            <span class="string">'ssl_key_file'</span> =&gt; <span class="string">'/var/www/html/services/nginx/ssl-cert/ssl.key'</span>,</div><div class="line">            <span class="string">'ssl_cert_file'</span> =&gt; <span class="string">'/var/www/html/services/nginx/ssl-cert/ssl.crt'</span></div><div class="line">        );</div><div class="line">        <span class="keyword">$this</span>-&gt;server = <span class="keyword">new</span> Server(<span class="string">'0.0.0.0'</span>, <span class="number">9502</span>, SWOOLE_PROCESS, SWOOLE_SOCK_TCP | SWOOLE_SSL);</div><div class="line">        <span class="keyword">$this</span>-&gt;server-&gt;set($setConfig);</div><div class="line">        <span class="keyword">$this</span>-&gt;server-&gt;on(<span class="string">'open'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(Server $server, $request)</span> </span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"server: handshake success with fd&#123;$request-&gt;fd&#125;\n"</span>;</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">$this</span>-&gt;server-&gt;on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(Server $server, $frame)</span> </span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"receive from &#123;$frame-&gt;fd&#125;:&#123;$frame-&gt;data&#125;,opcode:&#123;$frame-&gt;opcode&#125;,fin:&#123;$frame-&gt;finish&#125;\n"</span>;</div><div class="line">            $message = json_decode($frame-&gt;data);</div><div class="line">            $timestamp = $message-&gt;timestamp;</div><div class="line">            $token = $message-&gt;token;</div><div class="line">            swoole_timer_tick(<span class="number">1000</span>, <span class="function"><span class="keyword">function</span> <span class="params">($timerId)</span> <span class="title">use</span> <span class="params">($token, $server, $frame)</span> </span>&#123;</div><div class="line">                $token = <span class="keyword">$this</span>-&gt;findModel($token);</div><div class="line">                <span class="keyword">if</span> ($token === <span class="keyword">null</span> || $token-&gt;status == QrcodeToken::STATUS_EXPIRED) &#123;</div><div class="line">                    $response = json_encode([</div><div class="line">                        <span class="string">'timestamp'</span> =&gt; time(),</div><div class="line">                        <span class="string">'status'</span> =&gt; QrcodeToken::STATUS_EXPIRED</div><div class="line">                    ]);</div><div class="line">                    $server-&gt;push($frame-&gt;fd, $response);</div><div class="line">                    swoole_timer_clear($timerId);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">if</span> ($server-&gt;exist($frame-&gt;fd) &amp;&amp; in_array($token-&gt;status, [QrcodeToken::STATUS_SCANNED, QrcodeToken::STATUS_LOGGED_IN])) &#123;</div><div class="line">                        $response = json_encode([</div><div class="line">                            <span class="string">'timestamp'</span> =&gt; $token-&gt;updated_at,</div><div class="line">                            <span class="string">'status'</span> =&gt; $token-&gt;status</div><div class="line">                        ]);</div><div class="line">                        $server-&gt;push($frame-&gt;fd, $response);</div><div class="line">                    &#125;</div><div class="line">                &#125;;</div><div class="line">            &#125;);</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">$this</span>-&gt;server-&gt;on(<span class="string">'close'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(Server $server, $fd)</span> </span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"client &#123;$fd&#125; closed\n"</span>;</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">$this</span>-&gt;server-&gt;start();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">findModel</span><span class="params">($id)</span></span></div><div class="line">    &#123;</div><div class="line">        clearstatcache();</div><div class="line">        $token = QrcodeToken::findOne([<span class="string">'id'</span> =&gt; $id]);</div><div class="line">        <span class="keyword">return</span> $token;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>如果你的网站本身是https，那必须要用wss，就是在原来的ws连接的基础上加入对应的ssl连接证书,注意如果你是在本地连接的话，因为证书需要对应的域名，可以通过修改linux环境下的hosts文件，将127.0.0.1的对应域名改成你证书的域名即可。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">var error = false;</div><div class="line">    var timestamp = &#123;$timestamp&#125;;</div><div class="line">    var _t = '&#123;$token&#125;';</div><div class="line">    function startWebSocket()&#123;</div><div class="line">        var host=document.domain;</div><div class="line">        websocket = new WebSocket('wss://' + host + ':9502');</div><div class="line">        websocket.onopen = function (evt) &#123;</div><div class="line">            var message=&#123;</div><div class="line">                timestamp:timestamp,</div><div class="line">                token:_t</div><div class="line">            &#125;;</div><div class="line">            if(message!==null)&#123;</div><div class="line">                websocket.send(JSON.stringify(message));</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        websocket.onclose = function (evt) &#123;</div><div class="line">            console.log(\"关闭连接\");</div><div class="line">        &#125;;</div><div class="line">        websocket.onmessage = function (evt) &#123;</div><div class="line">            var response=JSON.parse(evt.data);</div><div class="line">            if(response.status==1)&#123;                  </div><div class="line">              $('#fn-tips').text('已扫码, 请点击确认');</div><div class="line">              timestamp = response.timestamp;</div><div class="line">            &#125;</div><div class="line">            if(response.status==2)&#123;</div><div class="line">              $('#fn-tips').text('已登录, 正在跳转···');</div><div class="line">              setTimeout(function()&#123;</div><div class="line">                $('#ff-qrcode-token').submit();                    </div><div class="line">              &#125;,500);                  </div><div class="line">            &#125;</div><div class="line">            if(response.status==-2)&#123;</div><div class="line">              alert('二维码已失效, 请刷新页面');</div><div class="line">            &#125;</div><div class="line">            error = false;</div><div class="line">            timestamp = response.timestamp;                </div><div class="line">        &#125;;</div><div class="line">        </div><div class="line">        websocket.onerror = function (evt, e) &#123;</div><div class="line">            console.log('错误代码: ' + evt.data);</div><div class="line">        &#125;;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/01/04/nginx配置优化/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          nginx配置优化
        
      </div>
    </a>
  
  
    <a href="/2017/12/10/使用Prometheus-Grafana监控/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">使用Prometheus+Grafana监控</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>






<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="websocket结合swoole进行wss访问" data-title="swoole利用websocket进行wss访问" data-url="http://graychen.git.io/2018/01/03/websocket结合swoole进行wss访问/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2018 Graychen
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: undefined,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: undefined,
		root: /
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>